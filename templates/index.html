<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Sudoku</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <!-- Your palette + tokens live here -->
  <link rel="stylesheet" href="/static/custom.css"/>
  <link rel="stylesheet" href="/static/board.css"/>
  <link rel="stylesheet" href="/static/response.css"/>
  <link rel="stylesheet" href="/static/buttons.css"/>
</head>
<body>
  <div class="wrap">
    <div class="board" id="board" role="grid" aria-label="9 by 9 Sudoku board"></div>
    <p class="sr-only" id="board-help">
      Use arrow keys to move. Type digits 1 through 9 to fill a cell. Prefilled cells are read-only.
    </p>
  </div>
  <div class="response-window" id="response-window"></div>
  </div>

  <script>
    // Example puzzle (0 = empty). Replace with your own.
    const puzzle =
      "530070000" +
      "600195000" +
      "098000060" +
      "800060003" +
      "400803001" +
      "700020006" +
      "060000280" +
      "000419005" +
      "000080079";

    const boardEl = document.getElementById('board');

    // Build 9Ã—9 grid
    for (let r = 0; r < 9; r++) {
      for (let c = 0; c < 9; c++) {
        const idx = r * 9 + c;
        const v = puzzle[idx];
        const cell = document.createElement('div');
        cell.className = 'cell';
        cell.dataset.row = String(r);
        cell.dataset.col = String(c);
        cell.setAttribute('role', 'gridcell');

        const input = document.createElement('input');
        input.inputMode = 'numeric';
        input.autocomplete = 'off';
        input.maxLength = 1;
        input.ariaLabel = `Row ${r + 1} column ${c + 1}`;
        input.placeholder = ''; // optional

        if (v !== '0') {
          input.value = v;
          cell.dataset.given = 'true';
          input.readOnly = true;
          input.tabIndex = -1;
        } else {
          input.tabIndex = 0;
          input.addEventListener('beforeinput', (e) => {
            // Allow only digits 1..9, Backspace, Delete, etc.
            if (e.data && !/[1-9]/.test(e.data)) e.preventDefault();
          });
          input.addEventListener('input', (e) => {
            // Keep only the last valid digit 1..9
            e.target.value = e.target.value.replace(/[^1-9]/g, '').slice(-1);
          });
          // Arrow-key navigation
          input.addEventListener('keydown', (e) => {
            const key = e.key;
            if (!['ArrowUp','ArrowDown','ArrowLeft','ArrowRight'].includes(key)) return;
            e.preventDefault();
            let nr = r, nc = c;
            if (key === 'ArrowUp') nr = Math.max(0, r - 1);
            if (key === 'ArrowDown') nr = Math.min(8, r + 1);
            if (key === 'ArrowLeft') nc = Math.max(0, c - 1);
            if (key === 'ArrowRight') nc = Math.min(8, c + 1);
            const next = boardEl.querySelector(`.cell[data-row="${nr}"][data-col="${nc}"] input:not([readonly])`)
                      || boardEl.querySelector(`.cell[data-row="${nr}"][data-col="${nc}"] input`);
            next?.focus();
          });
        }

        cell.appendChild(input);
        boardEl.appendChild(cell);
      }
    }
  </script>

  <script src="/static/typewriter.js"></script>
  <script>
    const box = document.getElementById("response-window");
    typewrite(box, "Hello from typewriter!");
  </script>
</body>
</html>
